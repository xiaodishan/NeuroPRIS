# NeuroPRIS
Leveraging deep learning for 3D structure-based prediction of proteinâ€“RNA interactions across diverse cell lines

# Overview
RNA plays an integral part in the molecular biology of cellular organisms, and understanding how RNA sequences can be accurately predicted enhances our comprehension of their role. NeuroPRIS proposes an end-to-end deep learning solution for the prediction of RNA sequence properties. Using a combination of architectural innovations including BiLSTM and 3D coordinate integration, it offers a powerful tool for understanding RNA-centric processes. The model aims to classify RNA sequences while leveraging structural information, thus providing deeper insights into RNA functions.

# Requirements
Code can be accessed via our GitHub repository.
Our model predictions require both secondary and tertiary structures of RNA. We have uploaded the complete secondary and tertiary structures for 31,226 RNA sequences in the ./dataset directory for users to utilize directly. If the RNA you wish to predict is not in our database, you can generate the secondary structure using RNAfold and the tertiary structure using nsp. We recommend using the RNAfold and nsp packages we have provided.
All datasets and models were provided at below:
https://zenodo.org/records/14848782

## Secondary Structure with RNAfold:
Use the RNAfold package to generate the RNA secondary structure in dot-bracket notation. We provided ViennaRNA-2.6.3.tar.
Ensure you have RNAfold installed. You can download it from the provided package link.

## Tertiary Structure with nsp:
Use the nsp package to compute the RNA tertiary structure in .pdb format. We provided nsp-lib.tar.gz.
The nsp download package is available through our platform, ensuring compatibility and standardization.

## Custom Structure Support
We also support secondary structure data in dot-bracket format and tertiary structures in .pdb format generated by other compatible software.
Secondary Structure Format: You may use secondary structure data in the commonly accepted dot-bracket notation, which is compatible with our analysis pipeline.
Tertiary Structure Format: For tertiary structures, ensure that your data is in .pdb format. This is a widely used format in structural biology and is fully supported by our tools.


## Docker Instructions(recommend)
Welcome to NeuroPRIS, a deep learning tool designed for RNA sequence prediction. This package comes with a pre-built Docker image to ensure ease of use and consistent performance across different environments.

Install Docker: For installation details, please visit the Docker official documentation and follow the instructions for your operating system.

Load the Pre-packaged Image, We provide a pre-packaged Docker image file. You can load it using the following command:

    docker load -i NeuroPRIS_images.tar
 
Run the Docker container while enabling GPU support. This command will start the container in detached mode, allowing it to run in the background:

    docker run -d --gpus all --name neuropris -p 47708:8888 -v ./NeuroPRIS-master:./NeuroPRIS-master -e NVIDIA_DRIVER_CAPABILITIES=compute,utility -e NVIDIA_VISIBLE_DEVICES=all xdshan/neuropris:v1.0

Interact with the running container:

    docker exec -it neuropris /bin/bash
 
## Conda Alternative
If Docker is not an option, you can set up the environment using Conda.

Create a Conda Environment: Set up a new Conda environment to run NeuroPRIS:

    conda create --name neuropris python=3.8
 
Activate the Environment:
    
    conda activate neuropris
 
Install Dependencies: Install Python packages listed in the requirements.txt:

    pip install -r requirements.txt

# Usage

Firstly, ensure all datasets and related PDB files are prepared in the directory. Replace placeholders with actual paths and file names.

## Traning and Predicting
```python
python main.py 
    --negative_data_path=<negative_path> \
    --output_dataset_path=<output_directory> \
    --pdb_folder=<pdb_folder> \
    --data_name=<dataset_name>

example:
python ./main.py \
    --negative_data_path ./brain_ELAVL3_negative.txt \
    --output_dataset_path ./dataset \
    --pdb_folder ./3DRNA \
    --data_name brain_ELAVL3_dataset \
    --log_prefix ./log \
    --save_prefix ./model \
    --output_path ./output
```
We also provide step-by-step code execution to facilitate users in replacing their own data.

## Dataset Generating
Place the standard format .pdb files into the ./3DRNA directory, and ensure that the input txt file contains sequence and dot-bracket secondary structure data.
```python
python ./DatasetGenerate.py \
    --negative_data_path=<negative_path> \
    --output_dataset_path=<output_directory> \
    --pdb_folder=<pdb_folder> 

example:
python ./DatasetGenerate.py \
    --negative_data_path ./brain_ELAVL3_negative.txt \
    --output_dataset_path ./dataset \
    --pdb_folder ./3DRNA 
```
## Training
```python
python ./train.py \
    --output_dataset_path=<dataset_for_training> \
    --data_name=<dataset_name> \
    --save_prefix=<model_save_path> \

example:
python ./train.py \
    --output_dataset_path ./dataset \
    --data_name brain_ELAVL3_dataset \
    --save_prefix ./model \
```
## Predicting
```python
python ./predict.py \
    --test_data_path=<test_dataset_path> \
    --data_name=<data_name> \
    --save_prefix=<model_save_path> \
    --output_path=<output_directory>

example:
python ./predict.py \
    --test_data_path ./dataset/test_dataset \
    --data_name brain_ELAVL3_dataset \
    --save_prefix ./model \
    --output_path ./output
```
## Motif Generating
```python
python motif.py \
    --model_path=<model_path> \
    --dataset_path=<dataset_path> \
    --data_name=<data_name> \
    --output_path=<output_directory> \
    --seq_info_folder=<seq_info_folder> \
    --window_length=<window_length>
example:
python ./motif.py \
	--model_path ./model/brain_ELAVL3_dataset \
	--dataset_path ./dataset \
	--data_name brain_ELAVL3_dataset \
	--output_path ./output \
	--seq_info_folder ./dataset \
	--window_length 5
```
## Prediction Value
```python
python PredictedValue.py \
    --modelpath=<path_to_model_directory> \
    --predictdatapath=<path_to_predict_data_directory> \
    --outputpath=<path_to_output_directory> \
    --dataname=<dataset_name>
example:
python ./PredictedValue.py \
	--modelpath ./model/brain_ELAVL3_dataset \
	--predictdatapath ./dataset/predict_dataset \
	--outputpath ./output \
	--dataname brain_ELAVL3_dataset
```
---
# License
This project is covered under the **MIT License**.

For further queries, feel free to get in touch!

Contact: sunliang@sdfmu.edu.cn, shanxiaodi@sdfmu.edu.cn
